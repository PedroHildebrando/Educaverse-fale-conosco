<!DOCTYPE html> 
<html lang="pt-BR"> 
<head> 
    <meta charset="UTF-8" /> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /> 
    <title>Login e Cadastro</title> 
    <link rel="stylesheet" href="style.css" /> 
    <style>
       
        .form-container {
            
            max-width: 400px;
            margin: 50px auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1);
        }
       
        #cadastro-form-container {
            display: none; 
        }
        #resultado {
            margin-top: 15px;
            font-weight: bold;
        }
    </style>
</head> 
<body> 
    
    <div id="login-form-container" class="form-container"> 
        <h1>Acessar Conta</h1> 
        
        <form id="login-form"> 
            <label for="login_email">E-mail</label> 
            <input 
                type="email" 
                id="login_email" 
                name="email_cliente" 
                placeholder="seuemail@exemplo.com" 
                required 
            /> 
    
            <label for="login_senha">Senha</label> 
            <input 
                type="password" 
                id="login_senha" 
                name="senha" 
                placeholder="**********" 
                required 
            /> 
    
            <button type="submit" id="btn_login">Entrar</button> 
        </form> 
    
        <p id="login_resultado"></p> 
        
        <p><a href="#" id="link-para-cadastro">Não tenho conta? Cadastre-se</a></p> 
    </div> 

    <div id="cadastro-form-container" class="form-container"> 
        <h1>Criar Conta</h1> 
        
        <form id="cadastro-form"> 
            <label for="cadastro_email">E-mail</label> 
            <input 
                type="email" 
                id="cadastro_email" 
                name="email_cliente" 
                placeholder="seuemail@exemplo.com" 
                required 
            /> 
    
            <label for="cadastro_senha">Senha</label> 
            <input 
                type="password" 
                id="cadastro_senha" 
                name="senha" 
                placeholder="**********" 
                required 
            /> 
    
            <button type="submit" id="btn_cadastro">Cadastrar</button> 
        </form> 
    
        <p id="cadastro_resultado"></p> 
        
        <p><a href="#" id="link-para-login">Já tenho conta? Fazer Login</a></p> 
    </div> 
    
    <script> 
        // ----------------------------------------------------
        // LÓGICA DE ALTERNÂNCIA DE TELAS
        // ----------------------------------------------------
        const loginContainer = document.getElementById('login-form-container');
        const cadastroContainer = document.getElementById('cadastro-form-container');
        const linkParaCadastro = document.getElementById('link-para-cadastro');
        const linkParaLogin = document.getElementById('link-para-login');

        linkParaCadastro.addEventListener('click', (e) => {
            e.preventDefault();
            loginContainer.style.display = 'none';
            cadastroContainer.style.display = 'block';
        });

        linkParaLogin.addEventListener('click', (e) => {
            e.preventDefault();
            loginContainer.style.display = 'block';
            cadastroContainer.style.display = 'none';
        });


        async function enviarDados(endpoint, email, senha, resultadoElement) {
            resultadoElement.innerText = "Carregando...";
            resultadoElement.style.color = "blue";

            try { 
                const resposta = await fetch(`http://localhost:3000${endpoint}`, { 
                    method: "POST", 
                    headers: { 
                        "Accept": "application/json", 
                        "Content-Type": "application/json" 
                    }, 
                    body: JSON.stringify({ 
                        email_cliente: email, 
                        senha: senha 
                    }) 
                }); 
        
                const dados = await resposta.json(); 
        
                if (resposta.ok) { 
                    resultadoElement.innerText = dados.resposta || "Sucesso!"; 
                    resultadoElement.style.color = "green"; 
                } else { 
                    resultadoElement.innerText = dados.resposta || `Erro na ${endpoint.substring(1)}. Tente novamente.`; 
                    resultadoElement.style.color = "red"; 
                } 
        
            } catch (error) { 
                resultadoElement.innerText = "Erro: Não foi possível conectar ao servidor."; 
                resultadoElement.style.color = "darkred"; 
                console.error("Erro de conexão:", error); 
            } 
        }

      
        // LÓGICA DE CADASTRO
       
        document.getElementById("cadastro-form").addEventListener("submit", (event) => { 
            event.preventDefault(); 
        
            const email = document.getElementById("cadastro_email").value; 
            const senha = document.getElementById("cadastro_senha").value; 
            const resultado = document.getElementById("cadastro_resultado");

            enviarDados('/cadastro', email, senha, resultado);
        }); 

       
        // LÓGICA DE LOGIN
        
        document.getElementById("login-form").addEventListener("submit", (event) => { 
            event.preventDefault(); 
        
            const email = document.getElementById("login_email").value; 
            const senha = document.getElementById("login_senha").value; 
            const resultado = document.getElementById("login_resultado");

            enviarDados('/login', email, senha, resultado);
        }); 
    </script> 
    
</body> 

</html>
